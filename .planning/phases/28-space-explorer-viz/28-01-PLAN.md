# Phase 28-01 Plan: Space Explorer Implementation

## Done

1. **Deps** — react-plotly.js, plotly.js, leva, ml-pca (docs-site)
2. **Build script** — `scripts/space-data.mjs`: trait + combined PCA; `space:precompute` writes `public/space-data.json`
3. **Page** — `/play/reports/spaces`: hero | Plotly 3D | Leva; Space selector (Trait | Combined); colorBy (branch | type)
4. **Player projection** — Sliders → trait/feature vector → PCA project → 3D player point
5. **KNN** — k=10 in original space; clickable list; click points in viz for details
6. **Color** — Branch (perception, combat, craft, dialogue, archetype) or Type (skill, archetype, dialogue)
7. **Deltas** — Leva panels "Deltas (Traits)" and "Deltas (Features)" to simulate buffs/debuffs
8. **Docs** — Space Explorer section in spaces.mdx; code block in formulas index; nav link

## Done (continued)

- **Report integration** — Turn dropdown loads player state from play-reports API; replays to turn, syncs Leva traits/features

## Future

- **Realtime content visualizer** — See `.planning/TODO-realtime-content-visualizer.md`; content spaces shift during play (e.g. level 12 = different "level")

## Data flow

- Content: engine contracts → vectors (12D traits or 17D traits+features for combined)
- PCA: fit on content, project to 3D; store loadings for predict
- Player: vector from sliders or report → predict → 3D point
- KNN: in original space, sort by distance, take k
