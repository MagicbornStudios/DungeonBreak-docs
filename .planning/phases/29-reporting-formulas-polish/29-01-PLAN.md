# Phase 29-01 Plan: Reporting & Formulas Polish — JSON Viewer, Performance

## Answers

### 1. Are we using a JSON viewer?

**No.** We use a plain `<pre>` with `JSON.stringify(data, null, 2)`. No collapse/expand, no syntax highlighting, no tree UI.

**Plan:** Add `react-json-view-lite` — lightweight, collapsible, themed, no deps. Renders JSON as an interactive tree.

---

### 2. How laggy should we expect it?

**Expected behavior:**

| Area | Expectation |
|------|-------------|
| **Initial load** | Fine. space-data.json ~50–100KB, ~30 points. Fetch + parse &lt; 100ms. |
| **3D Plotly** | Slider drag can feel laggy. Plotly re-renders on every value change; no debounce. Each change triggers: traitVector → PCA project → KNN → reachability → Plotly update. |
| **JSON view** | Cheap. Small payload (~2–4KB). No Plotly. |
| **Report turn change** | Can stall for long traces. `GameEngine.create(seed)` + N `dispatch()` calls. ~120 turns ≈ 50–150ms depending on machine. |
| **Leva sliders** | Fire onChange continuously during drag — no debounce. |

**Mitigations (if needed later):**

- Debounce Leva updates before passing to Plotly (e.g. 100–150ms)
- Lazy-load Plotly (already dynamic import)
- For report: consider server-side replay or Web Worker

---

## Tasks

1. **Add react-json-view-lite** — Replace `<pre>` with tree viewer in JSON tab
2. **Document performance** — Note in phase summary / AGENTS.md that slider drag may lag; debounce is optional future work
3. **Optional:** Add simple debounce for viz updates during slider drag (Phase 29-02 or later)

## DoD

- JSON tab uses collapsible tree viewer — **Done** (react-json-view-lite)
- Performance notes documented — **Done** (this plan)
- No regression in 3D or report flows — **Done**
