# Phase 13-01 Plan - Contracts and Implementation Loops

## Objectives

1. Lock browser runtime contracts and parity scope.
2. Deliver `/play` terminal UX in docs.
3. Implement TS engine parity slices and persistence.
4. Add browser tests and dual CI release gates.
5. Update planning artifacts for loop traceability.

## Loop Breakdown

### 13-01 Planning + Contracts
- Update ROADMAP/REQUIREMENTS/TASK-REGISTRY/STATE/DECISIONS/PRD.
- Add browser parity matrix doc and Phase 13 folder artifacts.
- Define command surface and browser DoD.

### 13-02 `/play` Route + Terminal Shell
- Add `docs-site/app/(fumadocs)/play/page.tsx`.
- Add terminal client components in `docs-site/components/game/*`.
- Add homepage CTA to `/play`.

### 13-03 TS Engine Core Parity Slice
- Add world/core/player/prerequisite modules in `docs-site/lib/escape-the-dungeon/*`.
- Implement deterministic turn stepping and action availability.

### 13-04 TS Engine Advanced Parity Slice
- Add dialogue/skills/cutscenes/deeds/fame/simulation/combat/persistence modules.
- Finalize companion/murder/rumor/hostile pressure rules.

### 13-05 Browser Test + Publish Pipeline
- Add unit tests and e2e smoke (`docs-site/tests`).
- Add docs browser workflow.
- Gate terminal release workflow on browser checks.

### 13-06 Final Verification
- Run docs typecheck/build/unit/e2e.
- Keep Python baseline workflow intact.
- Confirm parity matrix and state docs reflect completion.

## Verification Commands

- `pnpm --dir docs-site run typecheck`
- `pnpm --dir docs-site run test:unit`
- `pnpm --dir docs-site run test:e2e`
- `pnpm --dir docs-site run build`
- `uv run --extra test pytest -q`
